:root{
  --container:1100px;
  --ink:#0f172a; --muted:#64748b; --brand:#1b6ef3;
  --map-top:180px;     /* header+toolbar 分 */
  --map-bottom:140px;  /* HUD 分 */
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;height:100%}
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans JP",sans-serif;color:var(--ink);background:#f8fafc}
a{color:#1b6ef3;text-decoration:none} a:hover{text-decoration:underline}

/* Header */
.header{position:sticky;top:0;z-index:50;background:#fff;border-bottom:1px solid #e2e8f0}
.header-inner{max-width:var(--container);margin:0 auto;height:56px;display:flex;align-items:center;justify-content:space-between;padding:0 16px}
.brand{font-weight:700}
.nav a{margin-left:16px;color:#0f172a}

/* Toolbar */
.toolbar{max-width:var(--container);margin:0 auto;padding:10px 16px;display:flex;gap:8px;align-items:center;flex-wrap:wrap;transition:all .25s ease}
.toolbar input[type="text"]{flex:1;min-width:220px;padding:10px;border:1px solid #e2e8f0;border-radius:10px;background:#fff}
.btn{display:inline-block;padding:10px 14px;border-radius:999px;border:1px solid #e2e8f0;background:#fff;color:#0f172a;font-weight:600}
.btn.primary{background:#1b6ef3;border-color:transparent;color:#fff}
.btn:disabled{opacity:.5;pointer-events:none}

/* Map viewport uses CSS vars for dynamic gaps */
#map{position:fixed;inset:var(--map-top) 0 var(--map-bottom) 0}

/* HUD */
.hud{position:fixed;left:0;right:0;bottom:0;background:rgba(255,255,255,.96);border-top:1px solid #e2e8f0}
.hud-inner{max-width:var(--container);margin:0 auto;display:flex;align-items:center;justify-content:space-between;gap:12px;padding:10px 16px}
.stat{display:flex;gap:6px;align-items:baseline}.stat b{font-size:20px}

/* Toast & Search card */
.toast{position:fixed;left:50%;transform:translateX(-50%);bottom:108px;background:#111827;color:#fff;padding:10px 14px;border-radius:10px;opacity:.96;display:none}
.card{position:fixed;left:50%;transform:translateX(-50%);top:66px;background:#fff;border:1px solid #e2e8f0;border-radius:12px;box-shadow:0 10px 30px rgba(15,23,42,.08);display:none;min-width:280px;max-width:calc(100vw - 24px);z-index:100;}
.card header{padding:10px 14px;border-bottom:1px solid #e2e8f0;font-weight:700}
.card .body{padding:10px 14px}
.card .item{padding:8px;border-radius:8px;cursor:pointer}
.card .item:hover{background:#f1f5f9}

/* ====== ナビ中のコンパクト表示 ====== */
body.navigating { --map-top:66px; }                /* toolbar畳むので map top 縮める */
body.navigating .toolbar { height:0; padding:0; overflow:hidden; border:0; }
body.navigating .nav { display:none; }             /* 右上リンクも隠す */

/* 右上：停止ボタン（ナビ中のみ固定表示・赤） */
#btnStop{
  position:fixed; top:10px; right:12px; z-index:60; display:none;
  background:#ef4444; color:#fff; border-color:transparent;
}
body.navigating #btnStop{ display:inline-block; }
body:not(.navigating) #btnStop{ position:static; display:inline-block; background:#fff; color:#0f172a; border:1px solid #e2e8f0; }

/* 右上：追従トグル（停止の左。ナビ中のみ表示） */
#btnFollowToggle{
  position:fixed; top:10px; right:112px; z-index:60; display:none;
  background:#fff; color:#0f172a; border:1px solid #e2e8f0;
}
body.navigating #btnFollowToggle{ display:inline-block; }
body:not(.navigating) #btnFollowToggle{ display:none; }

@media (max-width:680px){
  :root{ --map-top:206px; --map-bottom:160px; }
  body.navigating{ --map-top:66px; }
  .hud-inner{flex-wrap:wrap}
  #btnFollowToggle{ right:108px; }
}
